<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Service - –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            text-align: center;
        }

        .container {
            max-width: 800px;
            /* –ò–ó–ú–ï–ù–ï–ù–û: —É–≤–µ–ª–∏—á–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ –¥–ª—è JSON */
            margin: 50px auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #3498db;
            margin-bottom: 20px;
        }

        /* –ò–ó–ú–ï–ù–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
        }

        .tab-btn.active {
            background: #3498db;
            color: white;
        }

        .search-form {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .search-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .search-btn {
            padding: 12px 24px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }

        .search-btn:hover {
            background-color: #2980b9;
        }

        /* –ò–ó–ú–ï–ù–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è JSON —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .result {
            margin-top: 30px;
            text-align: left;
            border-top: 2px solid #eee;
            padding-top: 20px;
        }

        .json-result {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: monospace;
            white-space: pre-wrap;
        }

        .error {
            color: #e74c3c;
            padding: 10px;
            background: #fdeaea;
            border-radius: 4px;
            margin-top: 20px;
        }

        /* –ò–ó–ú–ï–ù–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± API */
        .api-info {
            margin-top: 30px;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 4px;
            font-size: 14px;
            color: #666;
        }

        .api-info code {
            background: #fff;
            padding: 2px 6px;
            border-radius: 3px;
            border: 1px solid #ddd;
        }

        .api-endpoints {
            margin-top: 10px;
            list-style: none;
            padding: 0;
        }

        .api-endpoints li {
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Order Service</h1>
        <p>–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–∫–∞–∑–∞—Ö</p>

        <!-- –ò–ó–ú–ï–ù–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É HTML –∏ JSON -->
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('html')">HTML View</button>
            <button class="tab-btn" onclick="switchTab('json')">JSON API</button>
        </div>

        <!-- –ò–ó–ú–ï–ù–ï–ù–û: HTML View Tab (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª) -->
        <div id="html-tab">
            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞ –≤ HTML —Ñ–æ—Ä–º–∞—Ç–µ</p>
            <div class="search-form">
                <input type="text" id="htmlOrderId" class="search-input"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ Order UID (–Ω–∞–ø—Ä–∏–º–µ—Ä, b563feb7b2b84b6test)" />
                <button onclick="searchHTML()" class="search-btn">–ù–∞–π—Ç–∏ –∑–∞–∫–∞–∑</button>
            </div>
        </div>

        <!-- –ò–ó–ú–ï–ù–ï–ù–û: JSON API Tab (–Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª) -->
        <div id="json-tab" style="display: none;">
            <p>–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ</p>
            <div class="search-form">
                <input type="text" id="jsonOrderId" class="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ Order UID" />
                <button onclick="searchJSON()" class="search-btn">–ü–æ–ª—É—á–∏—Ç—å JSON</button>
            </div>
            <div id="json-result" class="result" style="display: none;">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
                <pre id="json-display" class="json-result"></pre>
            </div>
            <div id="json-error" class="error" style="display: none;"></div>
        </div>

        <!-- –ò–ó–ú–ï–ù–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö -->
        <div class="api-info">
            <strong>üì° –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:</strong>
            <ul class="api-endpoints">
                <li><code>GET /order/{order_uid}</code> - HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–∫–∞–∑–∞</li>
                <li><code>GET /api/order/{order_uid}</code> - JSON –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞</li>
                <li><code>GET /api/health</code> - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–∞</li>
            </ul>
        </div>
    </div>

    <!-- –ò–ó–ú–ï–ù–ï–ù–û: –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π JavaScript —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π JSON API -->
    <script>
        // –ò–ó–ú–ï–ù–ï–ù–û: –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('html-tab').style.display = 'none';
            document.getElementById('json-tab').style.display = 'none';

            if (tab === 'html') {
                document.querySelector('.tab-btn:first-child').classList.add('active');
                document.getElementById('html-tab').style.display = 'block';
            } else {
                document.querySelector('.tab-btn:last-child').classList.add('active');
                document.getElementById('json-tab').style.display = 'block';
            }
        }

        // –ò–ó–ú–ï–ù–ï–ù–û: –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è HTML (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∞ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏)
        function searchHTML() {
            const orderId = document.getElementById('htmlOrderId').value.trim();
            if (orderId) {
                window.location.href = '/order/' + encodeURIComponent(orderId);
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ Order UID');
            }
        }

        // –ò–ó–ú–ï–ù–ï–ù–û: –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è JSON API
        async function searchJSON() {
            const orderId = document.getElementById('jsonOrderId').value.trim();
            const resultDiv = document.getElementById('json-result');
            const errorDiv = document.getElementById('json-error');
            const jsonDisplay = document.getElementById('json-display');

            resultDiv.style.display = 'none';
            errorDiv.style.display = 'none';

            if (!orderId) {
                errorDiv.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ Order UID';
                errorDiv.style.display = 'block';
                return;
            }

            try {
                const response = await fetch('/api/order/' + encodeURIComponent(orderId));
                const data = await response.json();

                if (response.ok && data.success) {
                    jsonDisplay.textContent = JSON.stringify(data.data, null, 2);
                    resultDiv.style.display = 'block';
                } else {
                    errorDiv.textContent = data.error || '–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω';
                    errorDiv.style.display = 'block';
                }
            } catch (err) {
                errorDiv.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ: ' + err.message;
                errorDiv.style.display = 'block';
            }
        }

        // –ò–ó–ú–ï–ù–ï–ù–û: –ü–æ–∏—Å–∫ –ø–æ Enter –¥–ª—è –æ–±–æ–∏—Ö –ø–æ–ª–µ–π
        document.getElementById('htmlOrderId').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                searchHTML();
            }
        });

        document.getElementById('jsonOrderId').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                searchJSON();
            }
        });
    </script>
</body>

</html>